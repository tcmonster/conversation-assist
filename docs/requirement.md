## 综述

- 面向跨语种即时沟通与邮件回复场景,帮助用户在多语言环境下快速理解对方消息并生成高质量回复
- 典型流程: 用户从外部沟通工具复制对方消息 → 粘贴到应用 → 查看 AI 翻译与解析 → 输入或选择回复意图 → AI 生成最终回复 → 用户复制发送
- 产品目标: 减少语言转换与内容润色的重复劳动,确保回复符合语境、语气与业务目标
- 核心范围: 专注单机本地使用,不涉及账号体系与协同,强调数据掌控与隐私安全

## 功能

- Conversation 管理: 支持创建/重命名/归档/删除会话,列表展示最近活动时间、关键摘要与语言标识; 会话数量无硬性上限,需在数据量增大时保障性能与可用性
- 消息流呈现: 每个 conversation 内按时间顺序记录原始消息、我方意图、AI 生成稿以及最终发送内容; 历史消息可编辑并基于修改重新生成
- 输入与生成: 左栏粘贴原始消息,右栏撰写或选择回复意图; 在缺省意图时可请求 AI 基于上下文自动补全; 默认以对方语种输出回复,必要时允许切换语言
- 翻译与解析: 支持对原始消息手动触发翻译/解析,结果在右栏展示; 可根据需要选择不同的解析模式(直译/意译/要点提取)并缓存结果
- 语料与语气选择: 右侧边栏提供预设语料勾选、语气风格、回复长度等控制项,勾选组合应记录于会话以便下次沿用,常用组合可保存为快捷方案
- AI 配置: 设置面板允许配置模型供应商与密钥、自定义提示词模板(参考信息与全文引用分类)、默认语气、上下文语料预设、翻译语言偏好; 回复生成与翻译模型可分别指定
- 历史与导出: 支持查看生成前后差异、标记重要对话、导出单条或整段对话; 提供全量数据导出与导入恢复,用于备份与迁移
- 快捷操作: 提供键盘快捷键(新建会话、触发生成、复制回复),并配合悬浮提示、状态提醒与容错反馈

## 界面

- 框架: 采用 shadcn sidebar 实现三栏布局——左栏会话列表,中间对话主区域(左右双栏),右栏为 AI 控制与上下文
- 会话列表: 支持搜索、快捷过滤(如未读/已标记)、收藏置顶与新建入口; 数据量大时提供虚拟列表或分页方案,维持良好性能
- 对话主区域: 左右列纵向对齐并同步滚动,每条消息卡片显示语言识别结果、时间戳、角色、状态(草稿/已发送),可展开查看详细解析
- 右侧控制栏: 展示当前选中语料、语气控制器、提示词预览、模型状态/额度消耗; 支持折叠以腾出编辑空间
- 反馈与警示: 关键操作配合 Toast/Tooltip,对生成失败、额度不足等情况提供清晰提示

## 技术

- 前端栈: 使用 shadcn/ui 与 tailwindcss 构建界面,结合 lucide-react 提供图标表达
- 动效层: 采用 motion(原 framer-motion) 营造视图切换、卡片展开与状态变更动画
- 状态管理: 规划使用轻量状态容器(如 Zustand)协调多栏联动、AI 请求状态、缓存与本地存储同步
- AI 接入: 抽象统一调用层,封装翻译/解析/生成流程,支持多模型或多提示词策略; 翻译与回复生成可使用不同模型配置
- 本地化模块: 内置语言检测、格式化与默认翻译偏好,确保多语场景下的体验一致性

## 数据存储

- 本地存储: 会话、消息、设置项与预设语料存放于浏览器 local storage,采用可迁移的数据结构
- 数据备份: 支持 JSON/Markdown 导出与导入恢复,在导入时校验版本与结构以避免冲突; 导出内容需覆盖全部会话与设置数据(含 prompt 配置),默认以单份全量文件保存
- 数据安全: 支持快速清理敏感会话、遮蔽个人信息字段; 所有数据默认仅保留在本机,不自动同步外部服务

## 提示词工程

- 目录规划: 建立独立 prompt 层,区分系统角色、上下文语料、用户意图、语气/风格等模块化文件,并使用平面标签支持快速筛选,暂不引入颜色或层级
- 语言规范: 核心 prompt 以英文维护以确保模型对齐度,用户配置的上下文语料可保持原语言
- 历史上下文: 自动截取会话历史(含 AI 与用户消息)注入 prompt,避免重复内容并帮助模型理解对话进程
- 组合方式: 生成前将各类 prompt 组合为约定 JSON schema,提供界面按钮预览最终注入内容
- 模板复用: 常用 prompt 组合可命名保存、复制与快速启用,通过标签与命名管理,不维护版本历史

## 产品范围与约束

- 会话数量不设上限,需针对大量数据场景提供列表性能优化与导航能力
- AI 回复默认使用对方语言输出,暂不提供多语种同时输出或多候选对比
- 产品仅支持单机本地使用,暂不考虑账号体系、同步或团队协作
- 预设提示词由用户在设置面板手动维护,需支持分类展示、搜索与复用
