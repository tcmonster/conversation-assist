# add-conversation-composer

## Summary
- 让会话视图底部输入区真正写入当前会话 feed: 左列可以新增对方消息或我方消息, 右列用于记录意图并触发“生成回复”占位。
- 解析生成意图/消息的对应关系, 在 feed 中保持“消息/解析”配对。
- 状态立即持久化到 localStorage, 刷新后仍能看到新增内容。

## Problem
- 目前底部两个 `ColumnComposer` 仅提供静态按钮, 无法新增消息或意图。
- feed 的配对结构需要业务逻辑以正确区分对方消息、我方消息及意图说明。
- 缺乏新增消息/意图后的提示/清空机制, 用户体验不完整。

## Goals
- 左列 composer 支持添加“收到的消息”“我方回复”两种动作, 自动生成对应 feed 行与镜像分析/意图项。
- 右列 composer 收纳意图草稿, 点击“生成回复”时将意图写入新的 feed 行(暂不调用 AI)并重置输入。
- 所有新增数据写入 ConversationProvider 状态并同步 localStorage。

## Non-Goals
- 不实现 AI 调用或实际回复生成。
- 不提供批量导入历史消息。
- 不涉及多会话同时编辑或协同能力。

## Risks & Mitigations
- **字段对齐复杂**: 在 provider 内封装“新增行”方法, 保证消息与镜像结构一致。
- **localStorage 膨胀**: 初期仅保存纯文本; 后续若需截断/压缩可再规划。
- **并发冲突**: 单人离线场景风险极低; 若后续引入协作再考虑冲突合并策略。
